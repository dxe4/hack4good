<!DOCTYPE HTML>
<html>
    <head>
        {% load staticfiles %}
        <style>
            body {
                margin: 0px;
                padding: 0px;
            }
            #tango {
                position: absolute;
                top: 10px;
                left: 10px;
                padding: 10px;
            }
            #container {
                display: inline-block;
                overflow: hidden;
                height: 1200px;
                width: 1200px;
                background-position: 1px 1px;
            }
        </style>
    </head>
    <body>
        <div id="container"></div>
        <script src="{% static 'jquery-2.1.0.min.js' %}"></script>
        <script src="{% static 'world_map.js' %}"></script>
        <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v5.0.1.min.js"></script>
        <script defer="defer">
            $(document).ready(function() {

                var path_dict = {};

                var stage = new Kinetic.Stage({
                    container: 'container',
                    width: 1200,
                    height: 1200
                });
                var mapLayer = new Kinetic.Layer({
                    y: 20,
                    scale: 1
                });
                var topLayer = new Kinetic.Layer({
                    y: 20,
                    scale: 1
                });
                /*
                * loop through country data stroed in the worldMap
                * variable defined in the worldMap.js asset
                */
                for(var key in window.world_map.shapes) {
                    var path = new Kinetic.Path({
                        data: worldMap.shapes[key],
                          fill: '#eee',
                          stroke: '#555',
                          strokeWidth: 1
                        }
                    );

                    path.country_key = key;

                    path.on('mouseover', function() {
                      console.log(this.country_key);
                      this.setFill('#111');
                      this.moveTo(topLayer);
                      topLayer.drawScene();
                    });
                    
                    path.on('mouseout', function() {
                      this.setFill('#eee');
                      this.moveTo(mapLayer);
                      topLayer.draw();
                    });
                    
                    mapLayer.add(path);
                }
                stage.add(mapLayer);
                stage.add(topLayer);
          });
        </script>
    </body>
</html>
